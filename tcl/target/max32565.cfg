# Maxim Integrated MAX32565 OpenOCD target configuration file
# www.maximintegrated.com

# adapter speed
adapter_khz 4000

# reset pin configuration
reset_config trst_and_srst

if {[using_jtag]} {
    jtag newtap max32565 cpu -irlen 4 -irmask 0xf -expected-id 0x0ba00477 -ignore-version
} else {
    swd newdap max32565 cpu -irlen 4 -irmask 0xf -expected-id 0x0ba00477 -ignore-version
}

# target configuration
target create max32565.cpu cortex_m -chain-position max32565.cpu
max32565.cpu configure -work-area-phys 0x20005000 -work-area-size 0x2000

# Change these to match the external flash chip
set xip_size 0x1000000
set xip_block 0x1000
set xip_dummy 0x0
set xip_read 0x3
set xip_write 0x2
set xip_erase 0x20
set xip_mass_erase 0xC7

# Do not change these, specific to the max32565
set xip_base 0x08000000
set spim_base 0x40027000
set spim_txfifo 0x400BC000
set spim_rxfifo 0x400BC004
set spim_io 0x0
set spim_clk 0x0
set spix_base 0x40026000
set spix_io 0x0
set spix_clk 0x0

# Enable or disable crypto and integrity
# set crypto_base 0x40001000
set crypto_base 0x0
# set integrity 0x1
set integrity 0x0

flash bank max32565.flash max32xxx_spi $xip_base $xip_size 0 0 max32565.cpu $xip_block $xip_dummy $xip_read $xip_write $xip_erase $xip_mass_erase $spim_base $spim_txfifo $spim_rxfifo $spim_io $spim_clk $spix_base $spix_io $spix_clk $crypto_base $integrity
